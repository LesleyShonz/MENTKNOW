{
  "version": 3,
  "sources": ["../../../../../../src/lib/editor/tools/EraserTool/children/Pointing.ts"],
  "sourcesContent": ["import { TLShapeId } from '@tldraw/tlschema'\nimport { FrameShapeUtil } from '../../../shapes/frame/FrameShapeUtil'\nimport { GroupShapeUtil } from '../../../shapes/group/GroupShapeUtil'\nimport { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Pointing extends StateNode {\n\tstatic override id = 'pointing'\n\n\tonEnter = () => {\n\t\tconst { inputs } = this.editor\n\n\t\tconst erasing = new Set<TLShapeId>()\n\n\t\tconst initialSize = erasing.size\n\n\t\tfor (const shape of [...this.editor.sortedShapesArray].reverse()) {\n\t\t\tif (this.editor.isPointInShape(inputs.currentPagePoint, shape)) {\n\t\t\t\t// Skip groups\n\t\t\t\tif (this.editor.isShapeOfType(shape, GroupShapeUtil)) continue\n\n\t\t\t\tconst hitShape = this.editor.getOutermostSelectableShape(shape)\n\n\t\t\t\t// If we've hit a frame after hitting any other shape, stop here\n\t\t\t\tif (this.editor.isShapeOfType(hitShape, FrameShapeUtil) && erasing.size > initialSize) break\n\n\t\t\t\terasing.add(hitShape.id)\n\t\t\t}\n\t\t}\n\n\t\tthis.editor.setErasingIds([...erasing])\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = (info) => {\n\t\tif (this.editor.inputs.isDragging) {\n\t\t\tthis.parent.transition('erasing', info)\n\t\t}\n\t}\n\n\toverride onPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onInterrupt: TLEventHandlers['onInterrupt'] = () => {\n\t\tthis.cancel()\n\t}\n\n\tcomplete() {\n\t\tconst { erasingIds } = this.editor\n\n\t\tif (erasingIds.length) {\n\t\t\tthis.editor.mark('erase end')\n\t\t\tthis.editor.deleteShapes(erasingIds)\n\t\t}\n\n\t\tthis.editor.setErasingIds([])\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\tcancel() {\n\t\tthis.editor.setErasingIds([])\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,4BAA+B;AAC/B,4BAA+B;AAE/B,uBAA0B;AAEnB,MAAM,iBAAiB,2BAAU;AAAA,EACvC,OAAgB,KAAK;AAAA,EAErB,UAAU,MAAM;AACf,UAAM,EAAE,OAAO,IAAI,KAAK;AAExB,UAAM,UAAU,oBAAI,IAAe;AAEnC,UAAM,cAAc,QAAQ;AAE5B,eAAW,SAAS,CAAC,GAAG,KAAK,OAAO,iBAAiB,EAAE,QAAQ,GAAG;AACjE,UAAI,KAAK,OAAO,eAAe,OAAO,kBAAkB,KAAK,GAAG;AAE/D,YAAI,KAAK,OAAO,cAAc,OAAO,oCAAc;AAAG;AAEtD,cAAM,WAAW,KAAK,OAAO,4BAA4B,KAAK;AAG9D,YAAI,KAAK,OAAO,cAAc,UAAU,oCAAc,KAAK,QAAQ,OAAO;AAAa;AAEvF,gBAAQ,IAAI,SAAS,EAAE;AAAA,MACxB;AAAA,IACD;AAEA,SAAK,OAAO,cAAc,CAAC,GAAG,OAAO,CAAC;AAAA,EACvC;AAAA,EAEA,gBAAkD,CAAC,SAAS;AAC3D,QAAI,KAAK,OAAO,OAAO,YAAY;AAClC,WAAK,OAAO,WAAW,WAAW,IAAI;AAAA,IACvC;AAAA,EACD;AAAA,EAES,cAA8C,MAAM;AAC5D,SAAK,SAAS;AAAA,EACf;AAAA,EAES,WAAwC,MAAM;AACtD,SAAK,OAAO;AAAA,EACb;AAAA,EAES,aAA4C,MAAM;AAC1D,SAAK,SAAS;AAAA,EACf;AAAA,EAES,cAA8C,MAAM;AAC5D,SAAK,OAAO;AAAA,EACb;AAAA,EAEA,WAAW;AACV,UAAM,EAAE,WAAW,IAAI,KAAK;AAE5B,QAAI,WAAW,QAAQ;AACtB,WAAK,OAAO,KAAK,WAAW;AAC5B,WAAK,OAAO,aAAa,UAAU;AAAA,IACpC;AAEA,SAAK,OAAO,cAAc,CAAC,CAAC;AAC5B,SAAK,OAAO,WAAW,QAAQ,CAAC,CAAC;AAAA,EAClC;AAAA,EAEA,SAAS;AACR,SAAK,OAAO,cAAc,CAAC,CAAC;AAC5B,SAAK,OAAO,WAAW,QAAQ,CAAC,CAAC;AAAA,EAClC;AACD;",
  "names": []
}
