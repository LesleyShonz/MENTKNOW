{"ast":null,"code":"import { useMemo } from \"react\";\nimport { useValue } from \"signia-react\";\nimport { useEditor } from \"./useEditor.mjs\";\nfunction usePresence(userId) {\n  var editor = useEditor();\n  var $presences = useMemo(function () {\n    return editor.store.query.records(\"instance_presence\", function () {\n      return {\n        userId: {\n          eq: userId\n        }\n      };\n    });\n  }, [editor, userId]);\n  var latestPresence = useValue(\"latestPresence:\".concat(userId), function () {\n    return $presences.value.slice().sort(function (a, b) {\n      return b.lastActivityTimestamp - a.lastActivityTimestamp;\n    })[0];\n  }, []);\n  return latestPresence !== null && latestPresence !== void 0 ? latestPresence : null;\n}\nexport { usePresence };","map":{"version":3,"names":["useMemo","useValue","useEditor","usePresence","userId","editor","$presences","store","query","records","eq","latestPresence","concat","value","slice","sort","a","b","lastActivityTimestamp"],"sources":["/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@tldraw/editor/src/lib/hooks/usePresence.ts"],"sourcesContent":["import { TLInstancePresence } from '@tldraw/tlschema'\nimport { useMemo } from 'react'\nimport { useValue } from 'signia-react'\nimport { useEditor } from './useEditor'\n\n// TODO: maybe move this to a computed property on the App class?\n/**\n * @returns The list of peer UserIDs\n * @internal\n */\nexport function usePresence(userId: string): TLInstancePresence | null {\n\tconst editor = useEditor()\n\n\tconst $presences = useMemo(() => {\n\t\treturn editor.store.query.records('instance_presence', () => ({\n\t\t\tuserId: { eq: userId },\n\t\t}))\n\t}, [editor, userId])\n\n\tconst latestPresence = useValue(\n\t\t`latestPresence:${userId}`,\n\t\t() => {\n\t\t\treturn $presences.value\n\t\t\t\t.slice()\n\t\t\t\t.sort((a, b) => b.lastActivityTimestamp - a.lastActivityTimestamp)[0]\n\t\t},\n\t\t[]\n\t)\n\n\treturn latestPresence ?? null\n}\n"],"mappings":"AACA,SAASA,OAAA,QAAe;AACxB,SAASC,QAAA,QAAgB;AACzB,SAASC,SAAA,QAAiB;AAOnB,SAASC,YAAYC,MAAA,EAA2C;EACtE,IAAMC,MAAA,GAASH,SAAA,CAAU;EAEzB,IAAMI,UAAA,GAAaN,OAAA,CAAQ,YAAM;IAChC,OAAOK,MAAA,CAAOE,KAAA,CAAMC,KAAA,CAAMC,OAAA,CAAQ,qBAAqB;MAAA,OAAO;QAC7DL,MAAA,EAAQ;UAAEM,EAAA,EAAIN;QAAO;MACtB;IAAA,CAAE;EACH,GAAG,CAACC,MAAA,EAAQD,MAAM,CAAC;EAEnB,IAAMO,cAAA,GAAiBV,QAAA,mBAAAW,MAAA,CACJR,MAAA,GAClB,YAAM;IACL,OAAOE,UAAA,CAAWO,KAAA,CAChBC,KAAA,CAAM,EACNC,IAAA,CAAK,UAACC,CAAA,EAAGC,CAAA;MAAA,OAAMA,CAAA,CAAEC,qBAAA,GAAwBF,CAAA,CAAEE,qBAAqB;IAAA,GAAE,CAAC;EACtE,GACA,EACD;EAEA,OAAOP,cAAA,aAAAA,cAAA,cAAAA,cAAA,GAAkB;AAC1B"},"metadata":{},"sourceType":"module","externalDependencies":[]}