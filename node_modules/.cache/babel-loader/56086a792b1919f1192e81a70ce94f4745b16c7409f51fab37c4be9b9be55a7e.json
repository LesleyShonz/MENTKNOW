{"ast":null,"code":"import _classCallCheck from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { jsx } from \"react/jsx-runtime\";\nimport classNames from \"classnames\";\nimport * as React from \"react\";\nimport { useStateTracking, useValue } from \"signia-react\";\nimport { useEditor } from \"../../index.mjs\";\nimport { useEditorComponents } from \"../hooks/useEditorComponents.mjs\";\nimport { OptionalErrorBoundary } from \"./ErrorBoundary.mjs\";\nvar ShapeWithPropsEquality = /*#__PURE__*/function () {\n  function ShapeWithPropsEquality(shape) {\n    _classCallCheck(this, ShapeWithPropsEquality);\n    this.shape = shape;\n  }\n  _createClass(ShapeWithPropsEquality, [{\n    key: \"equals\",\n    value: function equals(other) {\n      var _this$shape, _other$shape;\n      return ((_this$shape = this.shape) === null || _this$shape === void 0 ? void 0 : _this$shape.props) === (other === null || other === void 0 || (_other$shape = other.shape) === null || _other$shape === void 0 ? void 0 : _other$shape.props);\n    }\n  }]);\n  return ShapeWithPropsEquality;\n}();\nvar EvenInnererIndicator = function EvenInnererIndicator(_ref) {\n  var shape = _ref.shape,\n    util = _ref.util;\n  return useStateTracking(\"Indicator:\" + shape.type, function () {\n    return util.indicator(shape);\n  });\n};\nvar InnerIndicator = function InnerIndicator(_ref2) {\n  var editor = _ref2.editor,\n    id = _ref2.id;\n  var shape = useValue(\"shape\", function () {\n    return new ShapeWithPropsEquality(editor.store.get(id));\n  }, [editor, id]);\n  var _useEditorComponents = useEditorComponents(),\n    ShapeIndicatorErrorFallback = _useEditorComponents.ShapeIndicatorErrorFallback;\n  if (!shape.shape) return null;\n  return /* @__PURE__ */jsx(OptionalErrorBoundary, {\n    fallback: ShapeIndicatorErrorFallback ? function (error) {\n      return /* @__PURE__ */jsx(ShapeIndicatorErrorFallback, {\n        error: error\n      });\n    } : null,\n    onError: function onError(error) {\n      return editor.annotateError(error, {\n        origin: \"react.shapeIndicator\",\n        willCrashApp: false\n      });\n    },\n    children: /* @__PURE__ */jsx(EvenInnererIndicator, {\n      shape: shape.shape,\n      util: editor.getShapeUtil(shape.shape)\n    }, shape.shape.id)\n  });\n};\nvar _ShapeIndicator = function _ShapeIndicator(_ref3) {\n  var id = _ref3.id,\n    className = _ref3.className,\n    color = _ref3.color,\n    opacity = _ref3.opacity;\n  var editor = useEditor();\n  var transform = useValue(\"transform\", function () {\n    var pageTransform = editor.getPageTransformById(id);\n    if (!pageTransform) return \"\";\n    return pageTransform.toCssString();\n  }, [editor, id]);\n  return /* @__PURE__ */jsx(\"svg\", {\n    className: classNames(\"tl-overlays__item\", className),\n    children: /* @__PURE__ */jsx(\"g\", {\n      className: \"tl-shape-indicator\",\n      transform: transform,\n      stroke: color !== null && color !== void 0 ? color : \"var(--color-selected)\",\n      opacity: opacity,\n      children: /* @__PURE__ */jsx(InnerIndicator, {\n        editor: editor,\n        id: id\n      })\n    })\n  });\n};\nvar ShapeIndicator = React.memo(_ShapeIndicator);\nexport { InnerIndicator, ShapeIndicator };","map":{"version":3,"names":["jsx","classNames","React","useStateTracking","useValue","useEditor","useEditorComponents","OptionalErrorBoundary","ShapeWithPropsEquality","shape","_classCallCheck","_createClass","key","value","equals","other","_this$shape","_other$shape","props","EvenInnererIndicator","_ref","util","type","indicator","InnerIndicator","_ref2","editor","id","store","get","_useEditorComponents","ShapeIndicatorErrorFallback","fallback","error","onError","annotateError","origin","willCrashApp","children","getShapeUtil","_ShapeIndicator","_ref3","className","color","opacity","transform","pageTransform","getPageTransformById","toCssString","stroke","ShapeIndicator","memo"],"sources":["/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@tldraw/editor/src/lib/components/ShapeIndicator.tsx"],"sourcesContent":["import { TLShape, TLShapeId } from '@tldraw/tlschema'\nimport classNames from 'classnames'\nimport * as React from 'react'\nimport {\n\t// @ts-expect-error 'private' export\n\tuseStateTracking,\n\tuseValue,\n} from 'signia-react'\nimport { useEditor } from '../..'\nimport type { Editor } from '../editor/Editor'\nimport { ShapeUtil } from '../editor/shapes/ShapeUtil'\nimport { useEditorComponents } from '../hooks/useEditorComponents'\nimport { OptionalErrorBoundary } from './ErrorBoundary'\n\nclass ShapeWithPropsEquality {\n\tconstructor(public shape: TLShape | undefined) {}\n\tequals(other: ShapeWithPropsEquality) {\n\t\treturn this.shape?.props === other?.shape?.props\n\t}\n}\n\n// need an extra layer of indirection here to allow hooks to be used inside the indicator render\nconst EvenInnererIndicator = ({ shape, util }: { shape: TLShape; util: ShapeUtil<any> }) => {\n\treturn useStateTracking('Indicator:' + shape.type, () => util.indicator(shape))\n}\n\nexport const InnerIndicator = ({ editor, id }: { editor: Editor; id: TLShapeId }) => {\n\tconst shape = useValue('shape', () => new ShapeWithPropsEquality(editor.store.get(id)), [\n\t\teditor,\n\t\tid,\n\t])\n\n\tconst { ShapeIndicatorErrorFallback } = useEditorComponents()\n\n\tif (!shape.shape) return null\n\treturn (\n\t\t<OptionalErrorBoundary\n\t\t\tfallback={\n\t\t\t\tShapeIndicatorErrorFallback\n\t\t\t\t\t? (error) => <ShapeIndicatorErrorFallback error={error} />\n\t\t\t\t\t: null\n\t\t\t}\n\t\t\tonError={(error) =>\n\t\t\t\teditor.annotateError(error, { origin: 'react.shapeIndicator', willCrashApp: false })\n\t\t\t}\n\t\t>\n\t\t\t<EvenInnererIndicator\n\t\t\t\tkey={shape.shape.id}\n\t\t\t\tshape={shape.shape}\n\t\t\t\tutil={editor.getShapeUtil(shape.shape)}\n\t\t\t/>\n\t\t</OptionalErrorBoundary>\n\t)\n}\n\nexport type TLShapeIndicatorComponent = (props: {\n\tid: TLShapeId\n\tcolor?: string | undefined\n\topacity?: number\n\tclassName?: string\n}) => JSX.Element | null\n\nconst _ShapeIndicator: TLShapeIndicatorComponent = ({ id, className, color, opacity }) => {\n\tconst editor = useEditor()\n\n\tconst transform = useValue(\n\t\t'transform',\n\t\t() => {\n\t\t\tconst pageTransform = editor.getPageTransformById(id)\n\t\t\tif (!pageTransform) return ''\n\t\t\treturn pageTransform.toCssString()\n\t\t},\n\t\t[editor, id]\n\t)\n\n\treturn (\n\t\t<svg className={classNames('tl-overlays__item', className)}>\n\t\t\t<g\n\t\t\t\tclassName=\"tl-shape-indicator\"\n\t\t\t\ttransform={transform}\n\t\t\t\tstroke={color ?? 'var(--color-selected)'}\n\t\t\t\topacity={opacity}\n\t\t\t>\n\t\t\t\t<InnerIndicator editor={editor} id={id} />\n\t\t\t</g>\n\t\t</svg>\n\t)\n}\n\nexport const ShapeIndicator = React.memo(_ShapeIndicator)\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}