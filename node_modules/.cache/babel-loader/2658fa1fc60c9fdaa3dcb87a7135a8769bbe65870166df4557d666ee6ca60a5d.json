{"ast":null,"code":"import _toArray from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/toArray.js\";\nimport { ArrowShapeUtil, useEditor } from \"@tldraw/editor\";\nimport { assert, exhaustiveSwitchError } from \"@tldraw/utils\";\nimport { useValue } from \"signia-react\";\nfunction compactMenuItems(arr) {\n  return arr.filter(function (i) {\n    return i !== void 0 && i !== null && i !== false;\n  });\n}\nfunction menuGroup(id) {\n  for (var _len = arguments.length, children = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    children[_key - 1] = arguments[_key];\n  }\n  var childItems = compactMenuItems(children);\n  if (childItems.length === 0) return null;\n  return {\n    id: id,\n    type: \"group\",\n    checkbox: childItems.every(function (child) {\n      return child.type === \"item\" && child.actionItem.checkbox;\n    }),\n    disabled: childItems.every(function (child) {\n      return child.disabled;\n    }),\n    readonlyOk: childItems.some(function (child) {\n      return child.readonlyOk;\n    }),\n    children: childItems\n  };\n}\nfunction menuSubmenu(id, label) {\n  for (var _len2 = arguments.length, children = new Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n    children[_key2 - 2] = arguments[_key2];\n  }\n  var childItems = compactMenuItems(children);\n  if (childItems.length === 0) return null;\n  return {\n    id: id,\n    type: \"submenu\",\n    label: label,\n    children: childItems,\n    disabled: childItems.every(function (child) {\n      return child.disabled;\n    }),\n    readonlyOk: childItems.some(function (child) {\n      return child.readonlyOk;\n    })\n  };\n}\nfunction menuCustom(id) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var _opts$readonlyOk = opts.readonlyOk,\n    readonlyOk = _opts$readonlyOk === void 0 ? true : _opts$readonlyOk,\n    _opts$disabled = opts.disabled,\n    disabled = _opts$disabled === void 0 ? false : _opts$disabled;\n  return {\n    id: id,\n    type: \"custom\",\n    disabled: disabled,\n    readonlyOk: readonlyOk\n  };\n}\nfunction menuItem(actionItem) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (!actionItem) {\n    throw Error(\"No action item provided to menuItem\");\n  }\n  if (!actionItem.label) {\n    throw Error(\"Trying to create menu item for action item that doesn't have a label\");\n  }\n  var _opts$checked = opts.checked,\n    checked = _opts$checked === void 0 ? false : _opts$checked,\n    _opts$disabled2 = opts.disabled,\n    disabled = _opts$disabled2 === void 0 ? false : _opts$disabled2;\n  return {\n    id: actionItem.id,\n    type: \"item\",\n    actionItem: actionItem,\n    disabled: disabled,\n    checked: checked,\n    readonlyOk: actionItem.readonlyOk\n  };\n}\nfunction shapesWithUnboundArrows(editor) {\n  var selectedIds = editor.selectedIds;\n  var selectedShapes = selectedIds.map(function (id) {\n    return editor.getShapeById(id);\n  });\n  return selectedShapes.filter(function (shape) {\n    if (!shape) return false;\n    if (editor.isShapeOfType(shape, ArrowShapeUtil) && shape.props.start.type === \"binding\") {\n      return false;\n    }\n    if (editor.isShapeOfType(shape, ArrowShapeUtil) && shape.props.end.type === \"binding\") {\n      return false;\n    }\n    return true;\n  });\n}\nvar useThreeStackableItems = function useThreeStackableItems() {\n  var editor = useEditor();\n  return useValue(\"threeStackableItems\", function () {\n    return shapesWithUnboundArrows(editor).length > 2;\n  }, [editor]);\n};\nvar useAllowGroup = function useAllowGroup() {\n  var editor = useEditor();\n  return useValue(\"allowGroup\", function () {\n    return shapesWithUnboundArrows(editor).length > 1;\n  }, [editor]);\n};\nvar useAllowUngroup = function useAllowUngroup() {\n  var editor = useEditor();\n  return useValue(\"allowUngroup\", function () {\n    return editor.selectedIds.some(function (id) {\n      var _editor$getShapeById;\n      return ((_editor$getShapeById = editor.getShapeById(id)) === null || _editor$getShapeById === void 0 ? void 0 : _editor$getShapeById.type) === \"group\";\n    });\n  }, []);\n};\nfunction findMenuItem(menu, path) {\n  var item = _findMenuItem(menu, path);\n  assert(item, \"Menu item \".concat(path.join(\" > \"), \" not found\"));\n  return item;\n}\nfunction _findMenuItem(menu, path) {\n  var _path = _toArray(path),\n    next = _path[0],\n    rest = _path.slice(1);\n  if (!next) return null;\n  var item = menu.find(function (item2) {\n    return item2.id === next;\n  });\n  if (!item) return null;\n  switch (item.type) {\n    case \"group\":\n    case \"submenu\":\n      return rest.length === 0 ? item : _findMenuItem(item.children, rest);\n    case \"item\":\n    case \"custom\":\n      return rest.length === 0 ? item : null;\n    default:\n      exhaustiveSwitchError(item, \"type\");\n  }\n}\nvar showMenuPaste = typeof window !== \"undefined\" && \"navigator\" in window && Boolean(navigator.clipboard) && Boolean(navigator.clipboard.read);\nexport { compactMenuItems, findMenuItem, menuCustom, menuGroup, menuItem, menuSubmenu, showMenuPaste, useAllowGroup, useAllowUngroup, useThreeStackableItems };","map":{"version":3,"names":["ArrowShapeUtil","useEditor","assert","exhaustiveSwitchError","useValue","compactMenuItems","arr","filter","i","menuGroup","id","_len","arguments","length","children","Array","_key","childItems","type","checkbox","every","child","actionItem","disabled","readonlyOk","some","menuSubmenu","label","_len2","_key2","menuCustom","opts","undefined","_opts$readonlyOk","_opts$disabled","menuItem","Error","_opts$checked","checked","_opts$disabled2","shapesWithUnboundArrows","editor","selectedIds","selectedShapes","map","getShapeById","shape","isShapeOfType","props","start","end","useThreeStackableItems","useAllowGroup","useAllowUngroup","_editor$getShapeById","findMenuItem","menu","path","item","_findMenuItem","concat","join","_path","_toArray","next","rest","slice","find","item2","showMenuPaste","window","Boolean","navigator","clipboard","read"],"sources":["/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@tldraw/ui/src/lib/hooks/menuHelpers.ts"],"sourcesContent":["import { ArrowShapeUtil, Editor, useEditor } from '@tldraw/editor'\nimport { assert, exhaustiveSwitchError } from '@tldraw/utils'\nimport { useValue } from 'signia-react'\nimport { TLUiActionItem } from './useActions'\nimport { TLUiToolItem } from './useTools'\nimport { TLUiTranslationKey } from './useTranslation/TLUiTranslationKey'\n\n/** @public */\nexport type TLUiMenuChild = TLUiMenuItem | TLUiSubMenu | TLUiMenuGroup | TLUiCustomMenuItem\n\n/** @public */\nexport type TLUiCustomMenuItem = {\n\tid: string\n\ttype: 'custom'\n\tdisabled: boolean\n\treadonlyOk: boolean\n}\n\n/** @public */\nexport type TLUiMenuItem = {\n\tid: string\n\ttype: 'item'\n\treadonlyOk: boolean\n\tactionItem: TLUiActionItem\n\tdisabled: boolean\n\tchecked: boolean\n}\n\n/** @public */\nexport type TLUiMenuGroup = {\n\tid: string\n\ttype: 'group'\n\tcheckbox: boolean\n\tdisabled: boolean\n\treadonlyOk: boolean\n\tchildren: TLUiMenuChild[]\n}\n\n/** @public */\nexport type TLUiSubMenu = {\n\tid: string\n\ttype: 'submenu'\n\tlabel: TLUiTranslationKey\n\tdisabled: boolean\n\treadonlyOk: boolean\n\tchildren: TLUiMenuChild[]\n}\n\n/** @public */\nexport type TLUiMenuSchema = (TLUiMenuGroup | TLUiMenuItem | TLUiCustomMenuItem)[]\n\n/** @public */\nexport function compactMenuItems<T>(arr: T[]): Exclude<T, null | false | undefined>[] {\n\treturn arr.filter((i) => i !== undefined && i !== null && i !== false) as any\n}\n\n/** @public */\nexport function menuGroup(\n\tid: string,\n\t...children: (TLUiMenuChild | null | false)[]\n): TLUiMenuGroup | null {\n\tconst childItems = compactMenuItems(children)\n\n\tif (childItems.length === 0) return null\n\n\treturn {\n\t\tid,\n\t\ttype: 'group',\n\t\tcheckbox: childItems.every((child) => child.type === 'item' && child.actionItem.checkbox),\n\t\tdisabled: childItems.every((child) => child.disabled),\n\t\treadonlyOk: childItems.some((child) => child.readonlyOk),\n\t\tchildren: childItems,\n\t}\n}\n\n/** @public */\nexport function menuSubmenu(\n\tid: string,\n\tlabel: TLUiTranslationKey,\n\t...children: (TLUiMenuChild | null | false)[]\n): TLUiSubMenu | null {\n\tconst childItems = compactMenuItems(children)\n\tif (childItems.length === 0) return null\n\n\treturn {\n\t\tid,\n\t\ttype: 'submenu',\n\t\tlabel,\n\t\tchildren: childItems,\n\t\tdisabled: childItems.every((child) => child.disabled),\n\t\treadonlyOk: childItems.some((child) => child.readonlyOk),\n\t}\n}\n\n/** @public */\nexport function menuCustom(\n\tid: string,\n\topts = {} as Partial<{ readonlyOk: boolean; disabled: boolean }>\n) {\n\tconst { readonlyOk = true, disabled = false } = opts\n\treturn {\n\t\tid,\n\t\ttype: 'custom' as const,\n\t\tdisabled,\n\t\treadonlyOk,\n\t}\n}\n\n/** @public */\nexport function menuItem(\n\tactionItem: TLUiActionItem | TLUiToolItem,\n\topts = {} as Partial<{ checked: boolean; disabled: boolean }>\n): TLUiMenuItem {\n\tif (!actionItem) {\n\t\tthrow Error('No action item provided to menuItem')\n\t}\n\n\tif (!actionItem.label) {\n\t\tthrow Error(\"Trying to create menu item for action item that doesn't have a label\")\n\t}\n\n\tconst { checked = false, disabled = false } = opts\n\n\treturn {\n\t\tid: actionItem.id,\n\t\ttype: 'item' as const,\n\t\tactionItem,\n\t\tdisabled,\n\t\tchecked,\n\t\treadonlyOk: actionItem.readonlyOk,\n\t}\n}\n\nfunction shapesWithUnboundArrows(editor: Editor) {\n\tconst { selectedIds } = editor\n\tconst selectedShapes = selectedIds.map((id) => {\n\t\treturn editor.getShapeById(id)\n\t})\n\n\treturn selectedShapes.filter((shape) => {\n\t\tif (!shape) return false\n\t\tif (editor.isShapeOfType(shape, ArrowShapeUtil) && shape.props.start.type === 'binding') {\n\t\t\treturn false\n\t\t}\n\t\tif (editor.isShapeOfType(shape, ArrowShapeUtil) && shape.props.end.type === 'binding') {\n\t\t\treturn false\n\t\t}\n\t\treturn true\n\t})\n}\n\n/** @internal */\nexport const useThreeStackableItems = () => {\n\tconst editor = useEditor()\n\treturn useValue('threeStackableItems', () => shapesWithUnboundArrows(editor).length > 2, [editor])\n}\n\n/** @internal */\nexport const useAllowGroup = () => {\n\tconst editor = useEditor()\n\treturn useValue('allowGroup', () => shapesWithUnboundArrows(editor).length > 1, [editor])\n}\n\n/** @internal */\nexport const useAllowUngroup = () => {\n\tconst editor = useEditor()\n\treturn useValue(\n\t\t'allowUngroup',\n\t\t() => editor.selectedIds.some((id) => editor.getShapeById(id)?.type === 'group'),\n\t\t[]\n\t)\n}\n\n/** @public */\nexport function findMenuItem(menu: TLUiMenuSchema, path: string[]) {\n\tconst item = _findMenuItem(menu, path)\n\tassert(item, `Menu item ${path.join(' > ')} not found`)\n\treturn item\n}\n\nfunction _findMenuItem(\n\tmenu: TLUiMenuSchema | TLUiMenuChild[],\n\tpath: string[]\n): TLUiMenuChild | null {\n\tconst [next, ...rest] = path\n\tif (!next) return null\n\n\tconst item = menu.find((item) => item.id === next)\n\tif (!item) return null\n\n\tswitch (item.type) {\n\t\tcase 'group':\n\t\tcase 'submenu':\n\t\t\treturn rest.length === 0 ? item : _findMenuItem(item.children, rest)\n\t\tcase 'item':\n\t\tcase 'custom':\n\t\t\treturn rest.length === 0 ? item : null\n\t\tdefault:\n\t\t\texhaustiveSwitchError(item, 'type')\n\t}\n}\n\nexport const showMenuPaste =\n\ttypeof window !== 'undefined' &&\n\t'navigator' in window &&\n\tBoolean(navigator.clipboard) &&\n\tBoolean(navigator.clipboard.read)\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}