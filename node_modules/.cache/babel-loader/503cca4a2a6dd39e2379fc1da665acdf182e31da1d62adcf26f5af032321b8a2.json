{"ast":null,"code":"import _objectSpread from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport * as React from \"react\";\nimport { loopToHtmlElement, releasePointerCapture, setPointerCapture } from \"../utils/dom.mjs\";\nimport { getPointerInfo } from \"../utils/svg.mjs\";\nimport { useEditor } from \"./useEditor.mjs\";\nfunction getHandle(editor, id, handleId) {\n  var shape = editor.getShapeById(id);\n  var util = editor.getShapeUtil(shape);\n  var handles = util.handles(shape);\n  return {\n    shape: shape,\n    handle: handles.find(function (h) {\n      return h.id === handleId;\n    })\n  };\n}\nfunction useHandleEvents(id, handleId) {\n  var editor = useEditor();\n  return React.useMemo(function () {\n    var onPointerDown = function onPointerDown(e) {\n      if (e.isKilled) return;\n      var target = loopToHtmlElement(e.currentTarget);\n      setPointerCapture(target, e);\n      var _getHandle = getHandle(editor, id, handleId),\n        shape = _getHandle.shape,\n        handle = _getHandle.handle;\n      if (!handle) return;\n      editor.dispatch(_objectSpread({\n        type: \"pointer\",\n        target: \"handle\",\n        handle: handle,\n        shape: shape,\n        name: \"pointer_down\"\n      }, getPointerInfo(e, editor.getContainer())));\n    };\n    var lastX, lastY;\n    var onPointerMove = function onPointerMove(e) {\n      if (e.isKilled) return;\n      if (e.clientX === lastX && e.clientY === lastY) return;\n      lastX = e.clientX;\n      lastY = e.clientY;\n      var _getHandle2 = getHandle(editor, id, handleId),\n        shape = _getHandle2.shape,\n        handle = _getHandle2.handle;\n      if (!handle) return;\n      editor.dispatch(_objectSpread({\n        type: \"pointer\",\n        target: \"handle\",\n        handle: handle,\n        shape: shape,\n        name: \"pointer_move\"\n      }, getPointerInfo(e, editor.getContainer())));\n    };\n    var onPointerUp = function onPointerUp(e) {\n      if (e.isKilled) return;\n      var target = loopToHtmlElement(e.currentTarget);\n      releasePointerCapture(target, e);\n      var _getHandle3 = getHandle(editor, id, handleId),\n        shape = _getHandle3.shape,\n        handle = _getHandle3.handle;\n      if (!handle) return;\n      editor.dispatch(_objectSpread({\n        type: \"pointer\",\n        target: \"handle\",\n        handle: handle,\n        shape: shape,\n        name: \"pointer_up\"\n      }, getPointerInfo(e, editor.getContainer())));\n    };\n    var onPointerEnter = function onPointerEnter(e) {\n      if (e.isKilled) return;\n      var _getHandle4 = getHandle(editor, id, handleId),\n        shape = _getHandle4.shape,\n        handle = _getHandle4.handle;\n      if (!handle) return;\n      editor.dispatch(_objectSpread({\n        type: \"pointer\",\n        target: \"handle\",\n        handle: handle,\n        shape: shape,\n        name: \"pointer_enter\"\n      }, getPointerInfo(e, editor.getContainer())));\n    };\n    var onPointerLeave = function onPointerLeave(e) {\n      if (e.isKilled) return;\n      var _getHandle5 = getHandle(editor, id, handleId),\n        shape = _getHandle5.shape,\n        handle = _getHandle5.handle;\n      if (!handle) return;\n      editor.dispatch(_objectSpread({\n        type: \"pointer\",\n        target: \"handle\",\n        handle: handle,\n        shape: shape,\n        name: \"pointer_leave\"\n      }, getPointerInfo(e, editor.getContainer())));\n    };\n    return {\n      onPointerDown: onPointerDown,\n      onPointerMove: onPointerMove,\n      onPointerUp: onPointerUp,\n      onPointerEnter: onPointerEnter,\n      onPointerLeave: onPointerLeave\n    };\n  }, [editor, id, handleId]);\n}\nexport { useHandleEvents };","map":{"version":3,"names":["React","loopToHtmlElement","releasePointerCapture","setPointerCapture","getPointerInfo","useEditor","getHandle","editor","id","handleId","shape","getShapeById","util","getShapeUtil","handles","handle","find","h","useHandleEvents","useMemo","onPointerDown","e","isKilled","target","currentTarget","_getHandle","dispatch","_objectSpread","type","name","getContainer","lastX","lastY","onPointerMove","clientX","clientY","_getHandle2","onPointerUp","_getHandle3","onPointerEnter","_getHandle4","onPointerLeave","_getHandle5"],"sources":["/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@tldraw/editor/src/lib/hooks/useHandleEvents.ts"],"sourcesContent":["import { TLArrowShape, TLLineShape, TLShapeId } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport { Editor } from '../editor/Editor'\nimport { loopToHtmlElement, releasePointerCapture, setPointerCapture } from '../utils/dom'\nimport { getPointerInfo } from '../utils/svg'\nimport { useEditor } from './useEditor'\n\nfunction getHandle(editor: Editor, id: TLShapeId, handleId: string) {\n\tconst shape = editor.getShapeById<TLArrowShape | TLLineShape>(id)!\n\tconst util = editor.getShapeUtil(shape)\n\tconst handles = util.handles(shape)\n\treturn { shape, handle: handles.find((h) => h.id === handleId) }\n}\n\nexport function useHandleEvents(id: TLShapeId, handleId: string) {\n\tconst editor = useEditor()\n\n\treturn React.useMemo(() => {\n\t\tconst onPointerDown = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\t// Must set pointer capture on an HTML element!\n\t\t\tconst target = loopToHtmlElement(e.currentTarget)\n\t\t\tsetPointerCapture(target, e)\n\n\t\t\tconst { shape, handle } = getHandle(editor, id, handleId)\n\n\t\t\tif (!handle) return\n\n\t\t\teditor.dispatch({\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'handle',\n\t\t\t\thandle,\n\t\t\t\tshape,\n\t\t\t\tname: 'pointer_down',\n\t\t\t\t...getPointerInfo(e, editor.getContainer()),\n\t\t\t})\n\t\t}\n\n\t\t// Track the last screen point\n\t\tlet lastX: number, lastY: number\n\n\t\tconst onPointerMove = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\t\t\tif (e.clientX === lastX && e.clientY === lastY) return\n\t\t\tlastX = e.clientX\n\t\t\tlastY = e.clientY\n\n\t\t\tconst { shape, handle } = getHandle(editor, id, handleId)\n\n\t\t\tif (!handle) return\n\n\t\t\teditor.dispatch({\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'handle',\n\t\t\t\thandle,\n\t\t\t\tshape,\n\t\t\t\tname: 'pointer_move',\n\t\t\t\t...getPointerInfo(e, editor.getContainer()),\n\t\t\t})\n\t\t}\n\n\t\tconst onPointerUp = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\tconst target = loopToHtmlElement(e.currentTarget)\n\t\t\treleasePointerCapture(target, e)\n\n\t\t\tconst { shape, handle } = getHandle(editor, id, handleId)\n\n\t\t\tif (!handle) return\n\n\t\t\teditor.dispatch({\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'handle',\n\t\t\t\thandle,\n\t\t\t\tshape,\n\t\t\t\tname: 'pointer_up',\n\t\t\t\t...getPointerInfo(e, editor.getContainer()),\n\t\t\t})\n\t\t}\n\n\t\tconst onPointerEnter = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\tconst { shape, handle } = getHandle(editor, id, handleId)\n\n\t\t\tif (!handle) return\n\n\t\t\teditor.dispatch({\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'handle',\n\t\t\t\thandle,\n\t\t\t\tshape,\n\t\t\t\tname: 'pointer_enter',\n\t\t\t\t...getPointerInfo(e, editor.getContainer()),\n\t\t\t})\n\t\t}\n\n\t\tconst onPointerLeave = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\tconst { shape, handle } = getHandle(editor, id, handleId)\n\n\t\t\tif (!handle) return\n\n\t\t\teditor.dispatch({\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'handle',\n\t\t\t\thandle,\n\t\t\t\tshape,\n\t\t\t\tname: 'pointer_leave',\n\t\t\t\t...getPointerInfo(e, editor.getContainer()),\n\t\t\t})\n\t\t}\n\n\t\treturn {\n\t\t\tonPointerDown,\n\t\t\tonPointerMove,\n\t\t\tonPointerUp,\n\t\t\tonPointerEnter,\n\t\t\tonPointerLeave,\n\t\t}\n\t}, [editor, id, handleId])\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}