{
  "version": 3,
  "sources": ["../../../../../../src/lib/editor/tools/SelectTool/children/EditingShape.ts"],
  "sourcesContent": ["import { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class EditingShape extends StateNode {\n\tstatic override id = 'editing_shape'\n\n\tonPointerEnter: TLEventHandlers['onPointerEnter'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'shape': {\n\t\t\t\tconst { selectedIds, focusLayerId } = this.editor\n\t\t\t\tconst hoveringShape = this.editor.getOutermostSelectableShape(\n\t\t\t\t\tinfo.shape,\n\t\t\t\t\t(parent) => !selectedIds.includes(parent.id)\n\t\t\t\t)\n\t\t\t\tif (hoveringShape.id !== focusLayerId) {\n\t\t\t\t\tthis.editor.setHoveredId(hoveringShape.id)\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tonPointerLeave: TLEventHandlers['onPointerLeave'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'shape': {\n\t\t\t\tthis.editor.setHoveredId(null)\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tonExit = () => {\n\t\tif (!this.editor.pageState.editingId) return\n\t\tconst { editingId } = this.editor.pageState\n\t\tif (!editingId) return\n\n\t\t// Clear the editing shape\n\t\tthis.editor.setEditingId(null)\n\n\t\tconst shape = this.editor.getShapeById(editingId)!\n\t\tconst util = this.editor.getShapeUtil(shape)\n\n\t\t// Check for changes on editing end\n\t\tutil.onEditEnd?.(shape)\n\t}\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'shape': {\n\t\t\t\tconst { shape } = info\n\n\t\t\t\tconst { editingId } = this.editor.pageState\n\n\t\t\t\tif (editingId) {\n\t\t\t\t\tif (shape.id === editingId) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tconst editingShape = this.editor.getShapeById(editingId)\n\n\t\t\t\t\tif (editingShape) {\n\t\t\t\t\t\tconst editingShapeUtil = this.editor.getShapeUtil(editingShape)\n\t\t\t\t\t\teditingShapeUtil.onEditEnd?.(editingShape)\n\n\t\t\t\t\t\tconst util = this.editor.getShapeUtil(shape)\n\n\t\t\t\t\t\t// If the user has clicked onto a different shape of the same type\n\t\t\t\t\t\t// which is available to edit, select it and begin editing it.\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tshape.type === editingShape.type &&\n\t\t\t\t\t\t\tutil.canEdit?.(shape) &&\n\t\t\t\t\t\t\t!this.editor.isShapeOrAncestorLocked(shape)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tthis.editor.setEditingId(shape.id)\n\t\t\t\t\t\t\tthis.editor.setHoveredId(shape.id)\n\t\t\t\t\t\t\tthis.editor.setSelectedIds([shape.id])\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.parent.transition('idle', info)\n\t\tthis.parent.current.value?.onPointerDown?.(info)\n\t}\n\n\tonComplete: TLEventHandlers['onComplete'] = (info) => {\n\t\tthis.parent.transition('idle', info)\n\t}\n\n\tonCancel: TLEventHandlers['onCancel'] = (info) => {\n\t\tthis.parent.transition('idle', info)\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,uBAA0B;AAEnB,MAAM,qBAAqB,2BAAU;AAAA,EAC3C,OAAgB,KAAK;AAAA,EAErB,iBAAoD,CAAC,SAAS;AAC7D,YAAQ,KAAK,QAAQ;AAAA,MACpB,KAAK,SAAS;AACb,cAAM,EAAE,aAAa,aAAa,IAAI,KAAK;AAC3C,cAAM,gBAAgB,KAAK,OAAO;AAAA,UACjC,KAAK;AAAA,UACL,CAAC,WAAW,CAAC,YAAY,SAAS,OAAO,EAAE;AAAA,QAC5C;AACA,YAAI,cAAc,OAAO,cAAc;AACtC,eAAK,OAAO,aAAa,cAAc,EAAE;AAAA,QAC1C;AACA;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,iBAAoD,CAAC,SAAS;AAC7D,YAAQ,KAAK,QAAQ;AAAA,MACpB,KAAK,SAAS;AACb,aAAK,OAAO,aAAa,IAAI;AAC7B;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,SAAS,MAAM;AACd,QAAI,CAAC,KAAK,OAAO,UAAU;AAAW;AACtC,UAAM,EAAE,UAAU,IAAI,KAAK,OAAO;AAClC,QAAI,CAAC;AAAW;AAGhB,SAAK,OAAO,aAAa,IAAI;AAE7B,UAAM,QAAQ,KAAK,OAAO,aAAa,SAAS;AAChD,UAAM,OAAO,KAAK,OAAO,aAAa,KAAK;AAG3C,SAAK,YAAY,KAAK;AAAA,EACvB;AAAA,EAEA,gBAAkD,CAAC,SAAS;AAC3D,YAAQ,KAAK,QAAQ;AAAA,MACpB,KAAK,SAAS;AACb,cAAM,EAAE,MAAM,IAAI;AAElB,cAAM,EAAE,UAAU,IAAI,KAAK,OAAO;AAElC,YAAI,WAAW;AACd,cAAI,MAAM,OAAO,WAAW;AAC3B;AAAA,UACD;AAEA,gBAAM,eAAe,KAAK,OAAO,aAAa,SAAS;AAEvD,cAAI,cAAc;AACjB,kBAAM,mBAAmB,KAAK,OAAO,aAAa,YAAY;AAC9D,6BAAiB,YAAY,YAAY;AAEzC,kBAAM,OAAO,KAAK,OAAO,aAAa,KAAK;AAI3C,gBACC,MAAM,SAAS,aAAa,QAC5B,KAAK,UAAU,KAAK,KACpB,CAAC,KAAK,OAAO,wBAAwB,KAAK,GACzC;AACD,mBAAK,OAAO,aAAa,MAAM,EAAE;AACjC,mBAAK,OAAO,aAAa,MAAM,EAAE;AACjC,mBAAK,OAAO,eAAe,CAAC,MAAM,EAAE,CAAC;AACrC;AAAA,YACD;AAAA,UACD;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAEA,SAAK,OAAO,WAAW,QAAQ,IAAI;AACnC,SAAK,OAAO,QAAQ,OAAO,gBAAgB,IAAI;AAAA,EAChD;AAAA,EAEA,aAA4C,CAAC,SAAS;AACrD,SAAK,OAAO,WAAW,QAAQ,IAAI;AAAA,EACpC;AAAA,EAEA,WAAwC,CAAC,SAAS;AACjD,SAAK,OAAO,WAAW,QAAQ,IAAI;AAAA,EACpC;AACD;",
  "names": []
}
