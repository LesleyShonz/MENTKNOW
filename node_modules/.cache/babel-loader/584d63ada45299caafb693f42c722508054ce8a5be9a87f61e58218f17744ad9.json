{"ast":null,"code":"import _regeneratorRuntime from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { useMemo } from \"react\";\nimport { preventDefault, releasePointerCapture, setPointerCapture } from \"../utils/dom.mjs\";\nimport { getPointerInfo } from \"../utils/svg.mjs\";\nimport { useEditor } from \"./useEditor.mjs\";\nfunction useCanvasEvents() {\n  var editor = useEditor();\n  var events = useMemo(function canvasEvents() {\n    var lastX, lastY;\n    function onPointerDown(e) {\n      if (e.isKilled) return;\n      if (e.button !== 0 && e.button !== 1 && e.button !== 5) return;\n      setPointerCapture(e.currentTarget, e);\n      editor.dispatch(_objectSpread({\n        type: \"pointer\",\n        target: \"canvas\",\n        name: \"pointer_down\"\n      }, getPointerInfo(e, editor.getContainer())));\n    }\n    function onPointerMove(e) {\n      if (e.isKilled) return;\n      if (e.clientX === lastX && e.clientY === lastY) return;\n      lastX = e.clientX;\n      lastY = e.clientY;\n      editor.dispatch(_objectSpread({\n        type: \"pointer\",\n        target: \"canvas\",\n        name: \"pointer_move\"\n      }, getPointerInfo(e, editor.getContainer())));\n    }\n    function onPointerUp(e) {\n      if (e.isKilled) return;\n      if (e.button !== 0 && e.button !== 1 && e.button !== 2 && e.button !== 5) return;\n      lastX = e.clientX;\n      lastY = e.clientY;\n      releasePointerCapture(e.currentTarget, e);\n      editor.dispatch(_objectSpread({\n        type: \"pointer\",\n        target: \"canvas\",\n        name: \"pointer_up\"\n      }, getPointerInfo(e, editor.getContainer())));\n    }\n    function onPointerEnter(e) {\n      if (e.isKilled) return;\n      editor.dispatch(_objectSpread({\n        type: \"pointer\",\n        target: \"canvas\",\n        name: \"pointer_enter\"\n      }, getPointerInfo(e, editor.getContainer())));\n    }\n    function onPointerLeave(e) {\n      if (e.isKilled) return;\n      editor.dispatch(_objectSpread({\n        type: \"pointer\",\n        target: \"canvas\",\n        name: \"pointer_leave\"\n      }, getPointerInfo(e, editor.getContainer())));\n    }\n    function onTouchStart(e) {\n      ;\n      e.isKilled = true;\n      document.body.click();\n      preventDefault(e);\n    }\n    function onTouchEnd(e) {\n      ;\n      e.isKilled = true;\n      if (e.target.tagName !== \"A\" && e.target.tagName !== \"TEXTAREA\") {\n        preventDefault(e);\n      }\n    }\n    function onDragOver(e) {\n      preventDefault(e);\n    }\n    function onDrop(_x) {\n      return _onDrop.apply(this, arguments);\n    }\n    function _onDrop() {\n      _onDrop = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(e) {\n        var _e$dataTransfer;\n        var files, rect;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              preventDefault(e);\n              if ((_e$dataTransfer = e.dataTransfer) !== null && _e$dataTransfer !== void 0 && (_e$dataTransfer = _e$dataTransfer.files) !== null && _e$dataTransfer !== void 0 && _e$dataTransfer.length) {\n                _context.next = 3;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 3:\n              files = Array.from(e.dataTransfer.files);\n              rect = editor.getContainer().getBoundingClientRect();\n              _context.next = 7;\n              return editor.putExternalContent({\n                type: \"files\",\n                files: files,\n                point: editor.screenToPage(e.clientX - rect.x, e.clientY - rect.y),\n                ignoreParent: false\n              });\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      return _onDrop.apply(this, arguments);\n    }\n    return {\n      onPointerDown: onPointerDown,\n      onPointerMove: onPointerMove,\n      onPointerUp: onPointerUp,\n      onPointerEnter: onPointerEnter,\n      onPointerLeave: onPointerLeave,\n      onDragOver: onDragOver,\n      onDrop: onDrop,\n      onTouchStart: onTouchStart,\n      onTouchEnd: onTouchEnd\n    };\n  }, [editor]);\n  return events;\n}\nexport { useCanvasEvents };","map":{"version":3,"names":["useMemo","preventDefault","releasePointerCapture","setPointerCapture","getPointerInfo","useEditor","useCanvasEvents","editor","events","canvasEvents","lastX","lastY","onPointerDown","e","isKilled","button","currentTarget","dispatch","_objectSpread","type","target","name","getContainer","onPointerMove","clientX","clientY","onPointerUp","onPointerEnter","onPointerLeave","onTouchStart","document","body","click","onTouchEnd","tagName","onDragOver","onDrop","_x","_onDrop","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_e$dataTransfer","files","rect","wrap","_callee$","_context","prev","next","dataTransfer","length","abrupt","Array","from","getBoundingClientRect","putExternalContent","point","screenToPage","x","y","ignoreParent","stop"],"sources":["/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@tldraw/editor/src/lib/hooks/useCanvasEvents.ts"],"sourcesContent":["import React, { useMemo } from 'react'\nimport { preventDefault, releasePointerCapture, setPointerCapture } from '../utils/dom'\nimport { getPointerInfo } from '../utils/svg'\nimport { useEditor } from './useEditor'\n\nexport function useCanvasEvents() {\n\tconst editor = useEditor()\n\n\tconst events = useMemo(\n\t\tfunction canvasEvents() {\n\t\t\t// Track the last screen point\n\t\t\tlet lastX: number, lastY: number\n\n\t\t\tfunction onPointerDown(e: React.PointerEvent) {\n\t\t\t\tif ((e as any).isKilled) return\n\t\t\t\tif (e.button !== 0 && e.button !== 1 && e.button !== 5) return\n\n\t\t\t\tsetPointerCapture(e.currentTarget, e)\n\n\t\t\t\teditor.dispatch({\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\tname: 'pointer_down',\n\t\t\t\t\t...getPointerInfo(e, editor.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction onPointerMove(e: React.PointerEvent) {\n\t\t\t\tif ((e as any).isKilled) return\n\n\t\t\t\tif (e.clientX === lastX && e.clientY === lastY) return\n\t\t\t\tlastX = e.clientX\n\t\t\t\tlastY = e.clientY\n\n\t\t\t\teditor.dispatch({\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\tname: 'pointer_move',\n\t\t\t\t\t...getPointerInfo(e, editor.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction onPointerUp(e: React.PointerEvent) {\n\t\t\t\tif ((e as any).isKilled) return\n\t\t\t\tif (e.button !== 0 && e.button !== 1 && e.button !== 2 && e.button !== 5) return\n\t\t\t\tlastX = e.clientX\n\t\t\t\tlastY = e.clientY\n\n\t\t\t\treleasePointerCapture(e.currentTarget, e)\n\n\t\t\t\teditor.dispatch({\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\tname: 'pointer_up',\n\t\t\t\t\t...getPointerInfo(e, editor.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction onPointerEnter(e: React.PointerEvent) {\n\t\t\t\tif ((e as any).isKilled) return\n\n\t\t\t\teditor.dispatch({\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\tname: 'pointer_enter',\n\t\t\t\t\t...getPointerInfo(e, editor.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction onPointerLeave(e: React.PointerEvent) {\n\t\t\t\tif ((e as any).isKilled) return\n\n\t\t\t\teditor.dispatch({\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\tname: 'pointer_leave',\n\t\t\t\t\t...getPointerInfo(e, editor.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction onTouchStart(e: React.TouchEvent) {\n\t\t\t\t;(e as any).isKilled = true\n\t\t\t\tdocument.body.click() // god damn it, but necessary for long presses to open the context menu\n\t\t\t\tpreventDefault(e)\n\t\t\t}\n\n\t\t\tfunction onTouchEnd(e: React.TouchEvent) {\n\t\t\t\t;(e as any).isKilled = true\n\t\t\t\tif (\n\t\t\t\t\t(e.target as HTMLElement).tagName !== 'A' &&\n\t\t\t\t\t(e.target as HTMLElement).tagName !== 'TEXTAREA'\n\t\t\t\t) {\n\t\t\t\t\tpreventDefault(e)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onDragOver(e: React.DragEvent<Element>) {\n\t\t\t\tpreventDefault(e)\n\t\t\t}\n\n\t\t\tasync function onDrop(e: React.DragEvent<Element>) {\n\t\t\t\tpreventDefault(e)\n\t\t\t\tif (!e.dataTransfer?.files?.length) return\n\n\t\t\t\tconst files = Array.from(e.dataTransfer.files)\n\n\t\t\t\tconst rect = editor.getContainer().getBoundingClientRect()\n\n\t\t\t\tawait editor.putExternalContent({\n\t\t\t\t\ttype: 'files',\n\t\t\t\t\tfiles,\n\t\t\t\t\tpoint: editor.screenToPage(e.clientX - rect.x, e.clientY - rect.y),\n\t\t\t\t\tignoreParent: false,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tonPointerDown,\n\t\t\t\tonPointerMove,\n\t\t\t\tonPointerUp,\n\t\t\t\tonPointerEnter,\n\t\t\t\tonPointerLeave,\n\t\t\t\tonDragOver,\n\t\t\t\tonDrop,\n\t\t\t\tonTouchStart,\n\t\t\t\tonTouchEnd,\n\t\t\t}\n\t\t},\n\t\t[editor]\n\t)\n\n\treturn events\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}