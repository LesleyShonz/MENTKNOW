{"ast":null,"code":"import _slicedToArray from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _classCallCheck from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _defineProperty from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport { Fragment, jsx, jsxs } from \"react/jsx-runtime\";\nimport { toDomPrecision } from \"@tldraw/primitives\";\nimport * as React from \"react\";\nimport { track } from \"signia-react\";\nimport { DefaultSpinner } from \"../../../components/DefaultSpinner.mjs\";\nimport { HTMLContainer } from \"../../../components/HTMLContainer.mjs\";\nimport { useIsEditing } from \"../../../hooks/useIsEditing.mjs\";\nimport { usePrefersReducedMotion } from \"../../../utils/dom.mjs\";\nimport { BaseBoxShapeUtil } from \"../BaseBoxShapeUtil.mjs\";\nimport { HyperlinkButton } from \"../shared/HyperlinkButton.mjs\";\nvar VideoShapeUtil = /*#__PURE__*/function (_BaseBoxShapeUtil) {\n  _inherits(VideoShapeUtil, _BaseBoxShapeUtil);\n  var _super = _createSuper(VideoShapeUtil);\n  function VideoShapeUtil() {\n    var _this;\n    _classCallCheck(this, VideoShapeUtil);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty(_assertThisInitialized(_this), \"canEdit\", function () {\n      return true;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"isAspectRatioLocked\", function () {\n      return true;\n    });\n    return _this;\n  }\n  _createClass(VideoShapeUtil, [{\n    key: \"defaultProps\",\n    value: function defaultProps() {\n      return {\n        w: 100,\n        h: 100,\n        assetId: null,\n        time: 0,\n        playing: true,\n        url: \"\"\n      };\n    }\n  }, {\n    key: \"component\",\n    value: function component(shape) {\n      return /* @__PURE__ */jsx(TLVideoUtilComponent, {\n        shape: shape,\n        videoUtil: this\n      });\n    }\n  }, {\n    key: \"indicator\",\n    value: function indicator(shape) {\n      return /* @__PURE__ */jsx(\"rect\", {\n        width: toDomPrecision(shape.props.w),\n        height: toDomPrecision(shape.props.h)\n      });\n    }\n  }, {\n    key: \"toSvg\",\n    value: function toSvg(shape) {\n      var g = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n      var image = document.createElementNS(\"http://www.w3.org/2000/svg\", \"image\");\n      image.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", serializeVideo(shape.id));\n      image.setAttribute(\"width\", shape.props.w.toString());\n      image.setAttribute(\"height\", shape.props.h.toString());\n      g.appendChild(image);\n      return g;\n    }\n  }]);\n  return VideoShapeUtil;\n}(BaseBoxShapeUtil);\n_defineProperty(VideoShapeUtil, \"type\", \"video\");\nfunction serializeVideo(id) {\n  var splitId = id.split(\":\")[1];\n  var video = document.querySelector(\".tl-video-shape-\".concat(splitId));\n  if (video) {\n    var canvas = document.createElement(\"canvas\");\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    canvas.getContext(\"2d\").drawImage(video, 0, 0);\n    return canvas.toDataURL(\"image/png\");\n  } else throw new Error(\"Video with id \" + splitId + \" not found\");\n}\nvar TLVideoUtilComponent = track(function TLVideoUtilComponent2(props) {\n  var shape = props.shape,\n    videoUtil = props.videoUtil;\n  var showControls = videoUtil.editor.getBounds(shape).w * videoUtil.editor.zoomLevel >= 110;\n  var asset = shape.props.assetId ? videoUtil.editor.getAssetById(shape.props.assetId) : null;\n  var _shape$props = shape.props,\n    w = _shape$props.w,\n    h = _shape$props.h,\n    time = _shape$props.time,\n    playing = _shape$props.playing;\n  var isEditing = useIsEditing(shape.id);\n  var prefersReducedMotion = usePrefersReducedMotion();\n  var rVideo = React.useRef(null);\n  var handlePlay = React.useCallback(function (e) {\n    var video = e.currentTarget;\n    videoUtil.editor.updateShapes([{\n      type: \"video\",\n      id: shape.id,\n      props: {\n        playing: true,\n        time: video.currentTime\n      }\n    }]);\n  }, [shape.id, videoUtil.editor]);\n  var handlePause = React.useCallback(function (e) {\n    var video = e.currentTarget;\n    videoUtil.editor.updateShapes([{\n      type: \"video\",\n      id: shape.id,\n      props: {\n        playing: false,\n        time: video.currentTime\n      }\n    }]);\n  }, [shape.id, videoUtil.editor]);\n  var handleSetCurrentTime = React.useCallback(function (e) {\n    var video = e.currentTarget;\n    if (isEditing) {\n      videoUtil.editor.updateShapes([{\n        type: \"video\",\n        id: shape.id,\n        props: {\n          time: video.currentTime\n        }\n      }]);\n    }\n  }, [isEditing, shape.id, videoUtil.editor]);\n  var _React$useState = React.useState(false),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    isLoaded = _React$useState2[0],\n    setIsLoaded = _React$useState2[1];\n  var handleLoadedData = React.useCallback(function (e) {\n    var video = e.currentTarget;\n    if (time !== video.currentTime) {\n      video.currentTime = time;\n    }\n    if (!playing) {\n      video.pause();\n    }\n    setIsLoaded(true);\n  }, [playing, time]);\n  React.useEffect(function () {\n    var video = rVideo.current;\n    if (!video) return;\n    if (isLoaded && !isEditing && time !== video.currentTime) {\n      video.currentTime = time;\n    }\n  }, [isEditing, isLoaded, time]);\n  React.useEffect(function () {\n    if (prefersReducedMotion) {\n      var video = rVideo.current;\n      video.pause();\n      video.currentTime = 0;\n    }\n  }, [rVideo, prefersReducedMotion]);\n  return /* @__PURE__ */jsxs(Fragment, {\n    children: [/* @__PURE__ */jsx(HTMLContainer, {\n      id: shape.id,\n      children: /* @__PURE__ */jsx(\"div\", {\n        className: \"tl-counter-scaled\",\n        children: asset !== null && asset !== void 0 && asset.props.src ? /* @__PURE__ */jsx(\"video\", {\n          ref: rVideo,\n          className: \"tl-video tl-video-shape-\".concat(shape.id.split(\":\")[1], \" tl-hitarea-stroke\"),\n          width: \"100%\",\n          height: \"100%\",\n          draggable: false,\n          playsInline: true,\n          autoPlay: true,\n          muted: true,\n          loop: true,\n          disableRemotePlayback: true,\n          disablePictureInPicture: true,\n          controls: isEditing && showControls,\n          onPlay: handlePlay,\n          onPause: handlePause,\n          onTimeUpdate: handleSetCurrentTime,\n          onLoadedData: handleLoadedData,\n          hidden: !isLoaded,\n          children: /* @__PURE__ */jsx(\"source\", {\n            src: asset.props.src\n          })\n        }) : /* @__PURE__ */jsx(\"g\", {\n          transform: \"translate(\".concat((w - 38) / 2, \", \").concat((h - 38) / 2, \")\"),\n          children: /* @__PURE__ */jsx(DefaultSpinner, {})\n        })\n      })\n    }), \"url\" in shape.props && shape.props.url && /* @__PURE__ */jsx(HyperlinkButton, {\n      url: shape.props.url,\n      zoomLevel: videoUtil.editor.zoomLevel\n    })]\n  });\n});\nexport { VideoShapeUtil };","map":{"version":3,"names":["Fragment","jsx","jsxs","toDomPrecision","React","track","DefaultSpinner","HTMLContainer","useIsEditing","usePrefersReducedMotion","BaseBoxShapeUtil","HyperlinkButton","VideoShapeUtil","_BaseBoxShapeUtil","_inherits","_super","_createSuper","_this","_classCallCheck","_len","arguments","length","args","Array","_key","call","apply","concat","_defineProperty","_assertThisInitialized","_createClass","key","value","defaultProps","w","h","assetId","time","playing","url","component","shape","TLVideoUtilComponent","videoUtil","indicator","width","props","height","toSvg","g","document","createElementNS","image","setAttributeNS","serializeVideo","id","setAttribute","toString","appendChild","splitId","split","video","querySelector","canvas","createElement","videoWidth","videoHeight","getContext","drawImage","toDataURL","Error","TLVideoUtilComponent2","showControls","editor","getBounds","zoomLevel","asset","getAssetById","_shape$props","isEditing","prefersReducedMotion","rVideo","useRef","handlePlay","useCallback","e","currentTarget","updateShapes","type","currentTime","handlePause","handleSetCurrentTime","_React$useState","useState","_React$useState2","_slicedToArray","isLoaded","setIsLoaded","handleLoadedData","pause","useEffect","current","children","className","src","ref","draggable","playsInline","autoPlay","muted","loop","disableRemotePlayback","disablePictureInPicture","controls","onPlay","onPause","onTimeUpdate","onLoadedData","hidden","transform"],"sources":["/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@tldraw/editor/src/lib/editor/shapes/video/VideoShapeUtil.tsx"],"sourcesContent":["import { toDomPrecision } from '@tldraw/primitives'\nimport { TLVideoShape } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport { track } from 'signia-react'\nimport { DefaultSpinner } from '../../../components/DefaultSpinner'\nimport { HTMLContainer } from '../../../components/HTMLContainer'\nimport { useIsEditing } from '../../../hooks/useIsEditing'\nimport { usePrefersReducedMotion } from '../../../utils/dom'\nimport { BaseBoxShapeUtil } from '../BaseBoxShapeUtil'\nimport { HyperlinkButton } from '../shared/HyperlinkButton'\n\n/** @public */\nexport class VideoShapeUtil extends BaseBoxShapeUtil<TLVideoShape> {\n\tstatic override type = 'video' as const\n\n\toverride canEdit = () => true\n\toverride isAspectRatioLocked = () => true\n\n\toverride defaultProps(): TLVideoShape['props'] {\n\t\treturn {\n\t\t\tw: 100,\n\t\t\th: 100,\n\t\t\tassetId: null,\n\t\t\ttime: 0,\n\t\t\tplaying: true,\n\t\t\turl: '',\n\t\t}\n\t}\n\n\tcomponent(shape: TLVideoShape) {\n\t\treturn <TLVideoUtilComponent shape={shape} videoUtil={this} />\n\t}\n\n\tindicator(shape: TLVideoShape) {\n\t\treturn <rect width={toDomPrecision(shape.props.w)} height={toDomPrecision(shape.props.h)} />\n\t}\n\n\ttoSvg(shape: TLVideoShape) {\n\t\tconst g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\t\tconst image = document.createElementNS('http://www.w3.org/2000/svg', 'image')\n\t\timage.setAttributeNS('http://www.w3.org/1999/xlink', 'href', serializeVideo(shape.id))\n\t\timage.setAttribute('width', shape.props.w.toString())\n\t\timage.setAttribute('height', shape.props.h.toString())\n\t\tg.appendChild(image)\n\n\t\treturn g\n\t}\n}\n\n// Function from v1, could be improved bu explicitly using this.model.time (?)\nfunction serializeVideo(id: string): string {\n\tconst splitId = id.split(':')[1]\n\tconst video = document.querySelector(`.tl-video-shape-${splitId}`) as HTMLVideoElement\n\tif (video) {\n\t\tconst canvas = document.createElement('canvas')\n\t\tcanvas.width = video.videoWidth\n\t\tcanvas.height = video.videoHeight\n\t\tcanvas.getContext('2d')!.drawImage(video, 0, 0)\n\t\treturn canvas.toDataURL('image/png')\n\t} else throw new Error('Video with id ' + splitId + ' not found')\n}\n\nconst TLVideoUtilComponent = track(function TLVideoUtilComponent(props: {\n\tshape: TLVideoShape\n\tvideoUtil: VideoShapeUtil\n}) {\n\tconst { shape, videoUtil } = props\n\tconst showControls = videoUtil.editor.getBounds(shape).w * videoUtil.editor.zoomLevel >= 110\n\tconst asset = shape.props.assetId ? videoUtil.editor.getAssetById(shape.props.assetId) : null\n\tconst { w, h, time, playing } = shape.props\n\tconst isEditing = useIsEditing(shape.id)\n\tconst prefersReducedMotion = usePrefersReducedMotion()\n\n\tconst rVideo = React.useRef<HTMLVideoElement>(null!)\n\n\tconst handlePlay = React.useCallback<React.ReactEventHandler<HTMLVideoElement>>(\n\t\t(e) => {\n\t\t\tconst video = e.currentTarget\n\n\t\t\tvideoUtil.editor.updateShapes([\n\t\t\t\t{\n\t\t\t\t\ttype: 'video',\n\t\t\t\t\tid: shape.id,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tplaying: true,\n\t\t\t\t\t\ttime: video.currentTime,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\t\t},\n\t\t[shape.id, videoUtil.editor]\n\t)\n\n\tconst handlePause = React.useCallback<React.ReactEventHandler<HTMLVideoElement>>(\n\t\t(e) => {\n\t\t\tconst video = e.currentTarget\n\n\t\t\tvideoUtil.editor.updateShapes([\n\t\t\t\t{\n\t\t\t\t\ttype: 'video',\n\t\t\t\t\tid: shape.id,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tplaying: false,\n\t\t\t\t\t\ttime: video.currentTime,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\t\t},\n\t\t[shape.id, videoUtil.editor]\n\t)\n\n\tconst handleSetCurrentTime = React.useCallback<React.ReactEventHandler<HTMLVideoElement>>(\n\t\t(e) => {\n\t\t\tconst video = e.currentTarget\n\n\t\t\tif (isEditing) {\n\t\t\t\tvideoUtil.editor.updateShapes([\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'video',\n\t\t\t\t\t\tid: shape.id,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\ttime: video.currentTime,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t])\n\t\t\t}\n\t\t},\n\t\t[isEditing, shape.id, videoUtil.editor]\n\t)\n\n\tconst [isLoaded, setIsLoaded] = React.useState(false)\n\n\tconst handleLoadedData = React.useCallback<React.ReactEventHandler<HTMLVideoElement>>(\n\t\t(e) => {\n\t\t\tconst video = e.currentTarget\n\t\t\tif (time !== video.currentTime) {\n\t\t\t\tvideo.currentTime = time\n\t\t\t}\n\n\t\t\tif (!playing) {\n\t\t\t\tvideo.pause()\n\t\t\t}\n\n\t\t\tsetIsLoaded(true)\n\t\t},\n\t\t[playing, time]\n\t)\n\n\t// If the current time changes and we're not editing the video, update the video time\n\tReact.useEffect(() => {\n\t\tconst video = rVideo.current\n\n\t\tif (!video) return\n\n\t\tif (isLoaded && !isEditing && time !== video.currentTime) {\n\t\t\tvideo.currentTime = time\n\t\t}\n\t}, [isEditing, isLoaded, time])\n\n\tReact.useEffect(() => {\n\t\tif (prefersReducedMotion) {\n\t\t\tconst video = rVideo.current\n\t\t\tvideo.pause()\n\t\t\tvideo.currentTime = 0\n\t\t}\n\t}, [rVideo, prefersReducedMotion])\n\n\treturn (\n\t\t<>\n\t\t\t<HTMLContainer id={shape.id}>\n\t\t\t\t<div className=\"tl-counter-scaled\">\n\t\t\t\t\t{asset?.props.src ? (\n\t\t\t\t\t\t<video\n\t\t\t\t\t\t\tref={rVideo}\n\t\t\t\t\t\t\tclassName={`tl-video tl-video-shape-${shape.id.split(':')[1]} tl-hitarea-stroke`}\n\t\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\t\theight=\"100%\"\n\t\t\t\t\t\t\tdraggable={false}\n\t\t\t\t\t\t\tplaysInline\n\t\t\t\t\t\t\tautoPlay\n\t\t\t\t\t\t\tmuted\n\t\t\t\t\t\t\tloop\n\t\t\t\t\t\t\tdisableRemotePlayback\n\t\t\t\t\t\t\tdisablePictureInPicture\n\t\t\t\t\t\t\tcontrols={isEditing && showControls}\n\t\t\t\t\t\t\tonPlay={handlePlay}\n\t\t\t\t\t\t\tonPause={handlePause}\n\t\t\t\t\t\t\tonTimeUpdate={handleSetCurrentTime}\n\t\t\t\t\t\t\tonLoadedData={handleLoadedData}\n\t\t\t\t\t\t\thidden={!isLoaded}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<source src={asset.props.src} />\n\t\t\t\t\t\t</video>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<g transform={`translate(${(w - 38) / 2}, ${(h - 38) / 2})`}>\n\t\t\t\t\t\t\t<DefaultSpinner />\n\t\t\t\t\t\t</g>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</HTMLContainer>\n\t\t\t{'url' in shape.props && shape.props.url && (\n\t\t\t\t<HyperlinkButton url={shape.props.url} zoomLevel={videoUtil.editor.zoomLevel} />\n\t\t\t)}\n\t\t</>\n\t)\n})\n"],"mappings":";;;;;;;AA8BS,SA0IPA,QAAA,EA1IOC,GAAA,EA0IPC,IAAA,QA1IO;AA9BT,SAASC,cAAA,QAAsB;AAE/B,YAAYC,KAAA,MAAW;AACvB,SAASC,KAAA,QAAa;AACtB,SAASC,cAAA,QAAsB;AAC/B,SAASC,aAAA,QAAqB;AAC9B,SAASC,YAAA,QAAoB;AAC7B,SAASC,uBAAA,QAA+B;AACxC,SAASC,gBAAA,QAAwB;AACjC,SAASC,eAAA,QAAuB;AAAA,IAGnBC,cAAA,0BAAAC,iBAAA;EAAAC,SAAA,CAAAF,cAAA,EAAAC,iBAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,cAAA;EAAA,SAAAA,eAAA;IAAA,IAAAK,KAAA;IAAAC,eAAA,OAAAN,cAAA;IAAA,SAAAO,IAAA,GAAAC,SAAA,CAAAC,MAAA,EAAAC,IAAA,OAAAC,KAAA,CAAAJ,IAAA,GAAAK,IAAA,MAAAA,IAAA,GAAAL,IAAA,EAAAK,IAAA;MAAAF,IAAA,CAAAE,IAAA,IAAAJ,SAAA,CAAAI,IAAA;IAAA;IAAAP,KAAA,GAAAF,MAAA,CAAAU,IAAA,CAAAC,KAAA,CAAAX,MAAA,SAAAY,MAAA,CAAAL,IAAA;IAAAM,eAAA,CAAAC,sBAAA,CAAAZ,KAAA,cAGO;MAAA,OAAM;IAAA;IAAAW,eAAA,CAAAC,sBAAA,CAAAZ,KAAA,0BACM;MAAA,OAAM;IAAA;IAAA,OAAAA,KAAA;EAAA;EAAAa,YAAA,CAAAlB,cAAA;IAAAmB,GAAA;IAAAC,KAAA,EAE5B,SAAAC,aAAA,EAAsC;MAC9C,OAAO;QACNC,CAAA,EAAG;QACHC,CAAA,EAAG;QACHC,OAAA,EAAS;QACTC,IAAA,EAAM;QACNC,OAAA,EAAS;QACTC,GAAA,EAAK;MACN;IACD;EAAA;IAAAR,GAAA;IAAAC,KAAA,EAEA,SAAAQ,UAAUC,KAAA,EAAqB;MAC9B,OAAO,eAAAxC,GAAA,CAACyC,oBAAA;QAAqBD,KAAA,EAAAA,KAAA;QAAcE,SAAA,EAAW;MAAA,CAAM;IAC7D;EAAA;IAAAZ,GAAA;IAAAC,KAAA,EAEA,SAAAY,UAAUH,KAAA,EAAqB;MAC9B,OAAO,eAAAxC,GAAA,CAAC;QAAK4C,KAAA,EAAO1C,cAAA,CAAesC,KAAA,CAAMK,KAAA,CAAMZ,CAAC;QAAGa,MAAA,EAAQ5C,cAAA,CAAesC,KAAA,CAAMK,KAAA,CAAMX,CAAC;MAAA,CAAG;IAC3F;EAAA;IAAAJ,GAAA;IAAAC,KAAA,EAEA,SAAAgB,MAAMP,KAAA,EAAqB;MAC1B,IAAMQ,CAAA,GAAIC,QAAA,CAASC,eAAA,CAAgB,8BAA8B,GAAG;MACpE,IAAMC,KAAA,GAAQF,QAAA,CAASC,eAAA,CAAgB,8BAA8B,OAAO;MAC5EC,KAAA,CAAMC,cAAA,CAAe,gCAAgC,QAAQC,cAAA,CAAeb,KAAA,CAAMc,EAAE,CAAC;MACrFH,KAAA,CAAMI,YAAA,CAAa,SAASf,KAAA,CAAMK,KAAA,CAAMZ,CAAA,CAAEuB,QAAA,CAAS,CAAC;MACpDL,KAAA,CAAMI,YAAA,CAAa,UAAUf,KAAA,CAAMK,KAAA,CAAMX,CAAA,CAAEsB,QAAA,CAAS,CAAC;MACrDR,CAAA,CAAES,WAAA,CAAYN,KAAK;MAEnB,OAAOH,CAAA;IACR;EAAA;EAAA,OAAArC,cAAA;AAAA,EAlCmCF,gBAAA;AAAAkB,eAAA,CAAvBhB,cAAA,UACW;AAqCxB,SAAS0C,eAAeC,EAAA,EAAoB;EAC3C,IAAMI,OAAA,GAAUJ,EAAA,CAAGK,KAAA,CAAM,GAAG,EAAE,CAAC;EAC/B,IAAMC,KAAA,GAAQX,QAAA,CAASY,aAAA,oBAAAnC,MAAA,CAAiCgC,OAAA,CAAS;EACjE,IAAIE,KAAA,EAAO;IACV,IAAME,MAAA,GAASb,QAAA,CAASc,aAAA,CAAc,QAAQ;IAC9CD,MAAA,CAAOlB,KAAA,GAAQgB,KAAA,CAAMI,UAAA;IACrBF,MAAA,CAAOhB,MAAA,GAASc,KAAA,CAAMK,WAAA;IACtBH,MAAA,CAAOI,UAAA,CAAW,IAAI,EAAGC,SAAA,CAAUP,KAAA,EAAO,GAAG,CAAC;IAC9C,OAAOE,MAAA,CAAOM,SAAA,CAAU,WAAW;EACpC,OAAO,MAAM,IAAIC,KAAA,CAAM,mBAAmBX,OAAA,GAAU,YAAY;AACjE;AAEA,IAAMjB,oBAAA,GAAuBrC,KAAA,CAAM,SAASkE,sBAAqBzB,KAAA,EAG9D;EACF,IAAQL,KAAA,GAAqBK,KAAA,CAArBL,KAAA;IAAOE,SAAA,GAAcG,KAAA,CAAdH,SAAA;EACf,IAAM6B,YAAA,GAAe7B,SAAA,CAAU8B,MAAA,CAAOC,SAAA,CAAUjC,KAAK,EAAEP,CAAA,GAAIS,SAAA,CAAU8B,MAAA,CAAOE,SAAA,IAAa;EACzF,IAAMC,KAAA,GAAQnC,KAAA,CAAMK,KAAA,CAAMV,OAAA,GAAUO,SAAA,CAAU8B,MAAA,CAAOI,YAAA,CAAapC,KAAA,CAAMK,KAAA,CAAMV,OAAO,IAAI;EACzF,IAAA0C,YAAA,GAAgCrC,KAAA,CAAMK,KAAA;IAA9BZ,CAAA,GAAA4C,YAAA,CAAA5C,CAAA;IAAGC,CAAA,GAAA2C,YAAA,CAAA3C,CAAA;IAAGE,IAAA,GAAAyC,YAAA,CAAAzC,IAAA;IAAMC,OAAA,GAAAwC,YAAA,CAAAxC,OAAA;EACpB,IAAMyC,SAAA,GAAYvE,YAAA,CAAaiC,KAAA,CAAMc,EAAE;EACvC,IAAMyB,oBAAA,GAAuBvE,uBAAA,CAAwB;EAErD,IAAMwE,MAAA,GAAS7E,KAAA,CAAM8E,MAAA,CAAyB,IAAK;EAEnD,IAAMC,UAAA,GAAa/E,KAAA,CAAMgF,WAAA,CACxB,UAACC,CAAA,EAAM;IACN,IAAMxB,KAAA,GAAQwB,CAAA,CAAEC,aAAA;IAEhB3C,SAAA,CAAU8B,MAAA,CAAOc,YAAA,CAAa,CAC7B;MACCC,IAAA,EAAM;MACNjC,EAAA,EAAId,KAAA,CAAMc,EAAA;MACVT,KAAA,EAAO;QACNR,OAAA,EAAS;QACTD,IAAA,EAAMwB,KAAA,CAAM4B;MACb;IACD,EACA;EACF,GACA,CAAChD,KAAA,CAAMc,EAAA,EAAIZ,SAAA,CAAU8B,MAAM,CAC5B;EAEA,IAAMiB,WAAA,GAActF,KAAA,CAAMgF,WAAA,CACzB,UAACC,CAAA,EAAM;IACN,IAAMxB,KAAA,GAAQwB,CAAA,CAAEC,aAAA;IAEhB3C,SAAA,CAAU8B,MAAA,CAAOc,YAAA,CAAa,CAC7B;MACCC,IAAA,EAAM;MACNjC,EAAA,EAAId,KAAA,CAAMc,EAAA;MACVT,KAAA,EAAO;QACNR,OAAA,EAAS;QACTD,IAAA,EAAMwB,KAAA,CAAM4B;MACb;IACD,EACA;EACF,GACA,CAAChD,KAAA,CAAMc,EAAA,EAAIZ,SAAA,CAAU8B,MAAM,CAC5B;EAEA,IAAMkB,oBAAA,GAAuBvF,KAAA,CAAMgF,WAAA,CAClC,UAACC,CAAA,EAAM;IACN,IAAMxB,KAAA,GAAQwB,CAAA,CAAEC,aAAA;IAEhB,IAAIP,SAAA,EAAW;MACdpC,SAAA,CAAU8B,MAAA,CAAOc,YAAA,CAAa,CAC7B;QACCC,IAAA,EAAM;QACNjC,EAAA,EAAId,KAAA,CAAMc,EAAA;QACVT,KAAA,EAAO;UACNT,IAAA,EAAMwB,KAAA,CAAM4B;QACb;MACD,EACA;IACF;EACD,GACA,CAACV,SAAA,EAAWtC,KAAA,CAAMc,EAAA,EAAIZ,SAAA,CAAU8B,MAAM,CACvC;EAEA,IAAAmB,eAAA,GAAgCxF,KAAA,CAAMyF,QAAA,CAAS,KAAK;IAAAC,gBAAA,GAAAC,cAAA,CAAAH,eAAA;IAA7CI,QAAA,GAAAF,gBAAA;IAAUG,WAAW,GAAAH,gBAAA;EAE5B,IAAMI,gBAAA,GAAmB9F,KAAA,CAAMgF,WAAA,CAC9B,UAACC,CAAA,EAAM;IACN,IAAMxB,KAAA,GAAQwB,CAAA,CAAEC,aAAA;IAChB,IAAIjD,IAAA,KAASwB,KAAA,CAAM4B,WAAA,EAAa;MAC/B5B,KAAA,CAAM4B,WAAA,GAAcpD,IAAA;IACrB;IAEA,IAAI,CAACC,OAAA,EAAS;MACbuB,KAAA,CAAMsC,KAAA,CAAM;IACb;IAEAF,WAAA,CAAY,IAAI;EACjB,GACA,CAAC3D,OAAA,EAASD,IAAI,CACf;EAGAjC,KAAA,CAAMgG,SAAA,CAAU,YAAM;IACrB,IAAMvC,KAAA,GAAQoB,MAAA,CAAOoB,OAAA;IAErB,IAAI,CAACxC,KAAA,EAAO;IAEZ,IAAImC,QAAA,IAAY,CAACjB,SAAA,IAAa1C,IAAA,KAASwB,KAAA,CAAM4B,WAAA,EAAa;MACzD5B,KAAA,CAAM4B,WAAA,GAAcpD,IAAA;IACrB;EACD,GAAG,CAAC0C,SAAA,EAAWiB,QAAA,EAAU3D,IAAI,CAAC;EAE9BjC,KAAA,CAAMgG,SAAA,CAAU,YAAM;IACrB,IAAIpB,oBAAA,EAAsB;MACzB,IAAMnB,KAAA,GAAQoB,MAAA,CAAOoB,OAAA;MACrBxC,KAAA,CAAMsC,KAAA,CAAM;MACZtC,KAAA,CAAM4B,WAAA,GAAc;IACrB;EACD,GAAG,CAACR,MAAA,EAAQD,oBAAoB,CAAC;EAEjC,OACC,eAAA9E,IAAA,CAAAF,QAAA;IACCsG,QAAA,kBAAArG,GAAA,CAACM,aAAA;MAAcgD,EAAA,EAAId,KAAA,CAAMc,EAAA;MACxB+C,QAAA,iBAAArG,GAAA,CAAC;QAAIsG,SAAA,EAAU;QACbD,QAAA,EAAA1B,KAAA,aAAAA,KAAA,eAAAA,KAAA,CAAO9B,KAAA,CAAM0D,GAAA,GACb,eAAAvG,GAAA,CAAC;UACAwG,GAAA,EAAKxB,MAAA;UACLsB,SAAA,6BAAA5E,MAAA,CAAsCc,KAAA,CAAMc,EAAA,CAAGK,KAAA,CAAM,GAAG,EAAE,CAAC;UAC3Df,KAAA,EAAM;UACNE,MAAA,EAAO;UACP2D,SAAA,EAAW;UACXC,WAAA,EAAW;UACXC,QAAA,EAAQ;UACRC,KAAA,EAAK;UACLC,IAAA,EAAI;UACJC,qBAAA,EAAqB;UACrBC,uBAAA,EAAuB;UACvBC,QAAA,EAAUlC,SAAA,IAAaP,YAAA;UACvB0C,MAAA,EAAQ/B,UAAA;UACRgC,OAAA,EAASzB,WAAA;UACT0B,YAAA,EAAczB,oBAAA;UACd0B,YAAA,EAAcnB,gBAAA;UACdoB,MAAA,EAAQ,CAACtB,QAAA;UAETM,QAAA,iBAAArG,GAAA,CAAC;YAAOuG,GAAA,EAAK5B,KAAA,CAAM9B,KAAA,CAAM0D;UAAA,CAAK;QAAA,CAC/B,IAEA,eAAAvG,GAAA,CAAC;UAAEsH,SAAA,eAAA5F,MAAA,CAAW,CAAcO,CAAA,GAAI,MAAM,SAAAP,MAAA,EAAOQ,CAAA,GAAI,MAAM;UACtDmE,QAAA,iBAAArG,GAAA,CAACK,cAAA,IAAe;QAAA,CACjB;MAAA,CAEF;IAAA,CACD,GACC,SAASmC,KAAA,CAAMK,KAAA,IAASL,KAAA,CAAMK,KAAA,CAAMP,GAAA,IACpC,eAAAtC,GAAA,CAACU,eAAA;MAAgB4B,GAAA,EAAKE,KAAA,CAAMK,KAAA,CAAMP,GAAA;MAAKoC,SAAA,EAAWhC,SAAA,CAAU8B,MAAA,CAAOE;IAAA,CAAW;EAAA,CAEhF;AAEF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}