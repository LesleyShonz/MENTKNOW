{"ast":null,"code":"import _toConsumableArray from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _createForOfIteratorHelper from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _defineProperty from \"/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport { FrameShapeUtil } from \"../../../shapes/frame/FrameShapeUtil.mjs\";\nimport { GroupShapeUtil } from \"../../../shapes/group/GroupShapeUtil.mjs\";\nimport { StateNode } from \"../../StateNode.mjs\";\nvar Pointing = /*#__PURE__*/function (_StateNode) {\n  _inherits(Pointing, _StateNode);\n  var _super = _createSuper(Pointing);\n  function Pointing() {\n    var _this;\n    _classCallCheck(this, Pointing);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty(_assertThisInitialized(_this), \"onEnter\", function () {\n      var inputs = _this.editor.inputs;\n      var erasing = /* @__PURE__ */new Set();\n      var initialSize = erasing.size;\n      var _iterator = _createForOfIteratorHelper(_toConsumableArray(_this.editor.sortedShapesArray).reverse()),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var shape = _step.value;\n          if (_this.editor.isPointInShape(inputs.currentPagePoint, shape)) {\n            if (_this.editor.isShapeOfType(shape, GroupShapeUtil)) continue;\n            var hitShape = _this.editor.getOutermostSelectableShape(shape);\n            if (_this.editor.isShapeOfType(hitShape, FrameShapeUtil) && erasing.size > initialSize) break;\n            erasing.add(hitShape.id);\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      _this.editor.setErasingIds(_toConsumableArray(erasing));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onPointerMove\", function (info) {\n      if (_this.editor.inputs.isDragging) {\n        _this.parent.transition(\"erasing\", info);\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onPointerUp\", function () {\n      _this.complete();\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onCancel\", function () {\n      _this.cancel();\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onComplete\", function () {\n      _this.complete();\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onInterrupt\", function () {\n      _this.cancel();\n    });\n    return _this;\n  }\n  _createClass(Pointing, [{\n    key: \"complete\",\n    value: function complete() {\n      var erasingIds = this.editor.erasingIds;\n      if (erasingIds.length) {\n        this.editor.mark(\"erase end\");\n        this.editor.deleteShapes(erasingIds);\n      }\n      this.editor.setErasingIds([]);\n      this.parent.transition(\"idle\", {});\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel() {\n      this.editor.setErasingIds([]);\n      this.parent.transition(\"idle\", {});\n    }\n  }]);\n  return Pointing;\n}(StateNode);\n_defineProperty(Pointing, \"id\", \"pointing\");\nexport { Pointing };","map":{"version":3,"names":["FrameShapeUtil","GroupShapeUtil","StateNode","Pointing","_StateNode","_inherits","_super","_createSuper","_this","_classCallCheck","_len","arguments","length","args","Array","_key","call","apply","concat","_defineProperty","_assertThisInitialized","inputs","editor","erasing","Set","initialSize","size","_iterator","_createForOfIteratorHelper","_toConsumableArray","sortedShapesArray","reverse","_step","s","n","done","shape","value","isPointInShape","currentPagePoint","isShapeOfType","hitShape","getOutermostSelectableShape","add","id","err","e","f","setErasingIds","info","isDragging","parent","transition","complete","cancel","_createClass","key","erasingIds","mark","deleteShapes"],"sources":["/Users/lesleyshinhiwa/Downloads/tldraw-partykit-example-2/Co/node_modules/@tldraw/editor/src/lib/editor/tools/EraserTool/children/Pointing.ts"],"sourcesContent":["import { TLShapeId } from '@tldraw/tlschema'\nimport { FrameShapeUtil } from '../../../shapes/frame/FrameShapeUtil'\nimport { GroupShapeUtil } from '../../../shapes/group/GroupShapeUtil'\nimport { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Pointing extends StateNode {\n\tstatic override id = 'pointing'\n\n\tonEnter = () => {\n\t\tconst { inputs } = this.editor\n\n\t\tconst erasing = new Set<TLShapeId>()\n\n\t\tconst initialSize = erasing.size\n\n\t\tfor (const shape of [...this.editor.sortedShapesArray].reverse()) {\n\t\t\tif (this.editor.isPointInShape(inputs.currentPagePoint, shape)) {\n\t\t\t\t// Skip groups\n\t\t\t\tif (this.editor.isShapeOfType(shape, GroupShapeUtil)) continue\n\n\t\t\t\tconst hitShape = this.editor.getOutermostSelectableShape(shape)\n\n\t\t\t\t// If we've hit a frame after hitting any other shape, stop here\n\t\t\t\tif (this.editor.isShapeOfType(hitShape, FrameShapeUtil) && erasing.size > initialSize) break\n\n\t\t\t\terasing.add(hitShape.id)\n\t\t\t}\n\t\t}\n\n\t\tthis.editor.setErasingIds([...erasing])\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = (info) => {\n\t\tif (this.editor.inputs.isDragging) {\n\t\t\tthis.parent.transition('erasing', info)\n\t\t}\n\t}\n\n\toverride onPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onInterrupt: TLEventHandlers['onInterrupt'] = () => {\n\t\tthis.cancel()\n\t}\n\n\tcomplete() {\n\t\tconst { erasingIds } = this.editor\n\n\t\tif (erasingIds.length) {\n\t\t\tthis.editor.mark('erase end')\n\t\t\tthis.editor.deleteShapes(erasingIds)\n\t\t}\n\n\t\tthis.editor.setErasingIds([])\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\tcancel() {\n\t\tthis.editor.setErasingIds([])\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}